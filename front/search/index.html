<html>

    <head>
        <link rel="stylesheet" type="text/css" href="style/style.css"/>
        <link rel="stylesheet" href="/back/webjars/bootstrap/4.3.1/css/bootstrap.min.css"/>
        <script src="/back/webjars/jquery/3.2.1/dist/jquery.min.js"></script>
        <!--<script src="http://localhost:8080/webjars/popper.js/1.12.9/dist/popper.min.js"></script>-->
        <script src="/back/webjars/bootstrap/4.3.1/js/bootstrap.min.js"></script>
        <link rel="stylesheet" href="/back/webjars/jquery-ui/1.12.1/jquery-ui.min.css"/>
        <script src="/back/webjars/jquery-ui/1.12.1/jquery-ui.min.js"></script>
    </head>

    <body>
        <div class="container-fluid">
            <div class="row justify-content-center">
                <div class="col-8">
                    <form onsubmit="searchSequence(); return false;">
                        <div class="form-group">
                            <label for="sequence">Search</label>
                            <input id="sequence" class="form-control" placeholder="Sequence">
                            <small class="form-text text-muted">Case sensitive search by one word</small>
                        </div>
                    </form>
                </div>
            </div>
            <div class="row justify-content-center">
                <div class="col-8">
                    <table class="table table-striped">
                        <tbody id="result" class="local-result-table"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </body>

    <script>

        $('#sequence').autocomplete({
            source: "/back/searchSequence?", // url-адрес
            minLength: 1,
            select: function (event, ui) {
                search(ui.item.id)
            }
        });

        function search(id) {
            $.ajax({
                url: "/back/getWord",
                data: ({
                    id: id
                }),
                success: function onSuccess(result) {
                    showResult(result)
                }
            });
        }

        function searchSequence() {
            $.ajax({
                url: "/back/searchWord",
                data: ({
                    sequence: $("#sequence").val()
                }),
                success: function onSuccess(result) {
                    showResult(result)
                }
            });
        }

        function showResult(words) {
            document.getElementById("result").innerHTML = "";
            for (var i = 0; i < words.length; i++) {
                //{"id":25,"name":"Гиперэкстензия"}
                for (var j = 0; j < words[i].files.length; j++) {
                    var tbody = document.getElementById("result");

                    var row = tbody.insertRow(tbody.rows.length);
                    var repository = row.insertCell(0);
                    repository.innerText = String(words[i].files[j].repository.name);

                    var fileName = row.insertCell(1);
                    fileName.innerHTML =
                        "<a target=\"_blank\" rel=\"noopener noreferrer\"" +
                        " href='/search/editor.html?id=" + words[i].files[j].id + "'>"
                        + String(words[i].files[j].name) +
                        "</a>";
                }
            }
            $('#sequence').autocomplete( "close" );
        }
    </script>

</html>